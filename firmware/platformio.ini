; Use the repo root as source dir and select files per environment
[platformio]
src_dir = .

[env:anchor]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
build_src_filter = +<anchor/> +<common/> -<tag/>
lib_deps =
  knolleary/PubSubClient @ ^2.8
  bblanchon/ArduinoJson @ ^6.21
  adafruit/Adafruit GFX Library @ ^1.11.7
  adafruit/Adafruit BusIO @ ^1.14.4
  adafruit/Adafruit SSD1306 @ ^2.5.7
build_flags = 
  -DROLE_ANCHOR
  -DMQTT_HOST=\"192.168.1.10\"
  -DMQTT_PORT=1883
  ; enable SIM_RANGES for development
  ; -DSIM_RANGES

[env:tag]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
build_src_filter = +<tag/> +<common/> -<anchor/>
lib_deps =
  knolleary/PubSubClient @ ^2.8
  bblanchon/ArduinoJson @ ^6.21
  adafruit/Adafruit GFX Library @ ^1.11.7
  adafruit/Adafruit BusIO @ ^1.14.4
  adafruit/Adafruit SSD1306 @ ^2.5.7
build_flags = 
  -DROLE_TAG
  -DMQTT_HOST=\"192.168.1.10\"
  -DMQTT_PORT=1883

[env:bridge]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
build_src_filter = +<provision_bridge/> +<common/pb_proto.cpp> +<common/cbor_codec.cpp> -<anchor/> -<tag/> -<common/provisioning_espnow.cpp> -<common/mqtt_client.cpp> -<common/mqtt_client.h> -<common/cmd_handler.*> -<common/display.*> -<common/uwb_at_adapter.*>
lib_deps =
  bblanchon/ArduinoJson @ ^6.21
upload_port = /dev/ttyUSB0
upload_speed = 115200
; PlatformIO config
